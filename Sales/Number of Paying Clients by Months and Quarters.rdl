<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Chart Name="Chart1">
        <ChartCategoryHierarchy>
          <ChartMembers>
            <ChartMember>
              <Group Name="Chart1_CategoryGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!YearNum.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!YearNum.Value</Value>
                </SortExpression>
              </SortExpressions>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart1_CategoryGroup1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!MonthNameEng.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!MonthNum.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!MonthNameEng.Value</Label>
                </ChartMember>
              </ChartMembers>
              <Label>=Fields!YearNum.Value</Label>
            </ChartMember>
          </ChartMembers>
        </ChartCategoryHierarchy>
        <ChartSeriesHierarchy>
          <ChartMembers>
            <ChartMember>
              <Group Name="Chart1_SeriesGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!ClientType.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!ClientType.Value</Value>
                </SortExpression>
              </SortExpressions>
              <Label>=Fields!ClientType.Value</Label>
            </ChartMember>
          </ChartMembers>
        </ChartSeriesHierarchy>
        <ChartData>
          <ChartSeriesCollection>
            <ChartSeries Name="ClientNum">
              <ChartDataPoints>
                <ChartDataPoint>
                  <ChartDataPointValues>
                    <Y>=Sum(Fields!ClientNum.Value)</Y>
                  </ChartDataPointValues>
                  <ChartDataLabel>
                    <Style />
                    <UseValueAsLabel>true</UseValueAsLabel>
                    <Visible>true</Visible>
                  </ChartDataLabel>
                  <Style />
                  <ChartMarker>
                    <Style />
                  </ChartMarker>
                  <DataElementOutput>Output</DataElementOutput>
                </ChartDataPoint>
              </ChartDataPoints>
              <Subtype>Stacked</Subtype>
              <Style />
              <ChartEmptyPoints>
                <Style />
                <ChartMarker>
                  <Style />
                </ChartMarker>
                <ChartDataLabel>
                  <Style />
                </ChartDataLabel>
              </ChartEmptyPoints>
              <ValueAxisName>Primary</ValueAxisName>
              <CategoryAxisName>Primary</CategoryAxisName>
              <ChartSmartLabel>
                <CalloutLineColor>Black</CalloutLineColor>
                <MinMovingDistance>0pt</MinMovingDistance>
              </ChartSmartLabel>
            </ChartSeries>
          </ChartSeriesCollection>
        </ChartData>
        <ChartAreas>
          <ChartArea Name="Default">
            <ChartCategoryAxes>
              <ChartAxis Name="Primary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Year / Month</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <Interval>1</Interval>
                <ChartMajorGridLines>
                  <Enabled>False</Enabled>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
              <ChartAxis Name="Secondary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Axis Title</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Enabled>False</Enabled>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Location>Opposite</Location>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
            </ChartCategoryAxes>
            <ChartValueAxes>
              <ChartAxis Name="Primary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Paying Clients Qty</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
              <ChartAxis Name="Secondary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Axis Title</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Location>Opposite</Location>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
            </ChartValueAxes>
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </ChartArea>
        </ChartAreas>
        <ChartLegends>
          <ChartLegend Name="Default">
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
              <FontSize>8pt</FontSize>
            </Style>
            <Position>BottomCenter</Position>
            <ChartLegendTitle>
              <Caption />
              <Style>
                <FontSize>8pt</FontSize>
                <FontWeight>Bold</FontWeight>
                <TextAlign>Center</TextAlign>
              </Style>
            </ChartLegendTitle>
            <HeaderSeparatorColor>Black</HeaderSeparatorColor>
            <ColumnSeparatorColor>Black</ColumnSeparatorColor>
          </ChartLegend>
        </ChartLegends>
        <ChartTitles>
          <ChartTitle Name="Default">
            <Caption>All Managers</Caption>
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
              <FontWeight>Bold</FontWeight>
              <TextAlign>General</TextAlign>
              <VerticalAlign>Top</VerticalAlign>
            </Style>
          </ChartTitle>
        </ChartTitles>
        <Palette>BrightPastel</Palette>
        <ChartBorderSkin>
          <Style>
            <BackgroundColor>Gray</BackgroundColor>
            <BackgroundGradientType>None</BackgroundGradientType>
            <Color>White</Color>
          </Style>
        </ChartBorderSkin>
        <ChartNoDataMessage Name="NoDataMessage">
          <Caption>No Data Available</Caption>
          <Style>
            <BackgroundGradientType>None</BackgroundGradientType>
            <TextAlign>General</TextAlign>
            <VerticalAlign>Top</VerticalAlign>
          </Style>
        </ChartNoDataMessage>
        <DataSetName>DStClientsMonths</DataSetName>
        <Top>1cm</Top>
        <Height>11cm</Height>
        <Width>17.5cm</Width>
        <Style>
          <Border>
            <Color>LightGrey</Color>
            <Style>None</Style>
          </Border>
          <BackgroundColor>White</BackgroundColor>
          <BackgroundGradientType>None</BackgroundGradientType>
        </Style>
      </Chart>
      <Tablix Name="Tablix11">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>17.5cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>10.92062cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Chart Name="Chart28">
                      <ChartCategoryHierarchy>
                        <ChartMembers>
                          <ChartMember>
                            <Group Name="Chart28_CategoryGroup1">
                              <GroupExpressions>
                                <GroupExpression>=Fields!YearNum.Value</GroupExpression>
                              </GroupExpressions>
                            </Group>
                            <SortExpressions>
                              <SortExpression>
                                <Value>=Fields!YearNum.Value</Value>
                              </SortExpression>
                            </SortExpressions>
                            <ChartMembers>
                              <ChartMember>
                                <Group Name="Chart28_CategoryGroup">
                                  <GroupExpressions>
                                    <GroupExpression>=Fields!MonthNameEng.Value</GroupExpression>
                                  </GroupExpressions>
                                </Group>
                                <SortExpressions>
                                  <SortExpression>
                                    <Value>=Fields!MonthNum.Value</Value>
                                  </SortExpression>
                                </SortExpressions>
                                <Label>=Fields!MonthNameEng.Value</Label>
                              </ChartMember>
                            </ChartMembers>
                            <Label>=Fields!YearNum.Value</Label>
                          </ChartMember>
                        </ChartMembers>
                      </ChartCategoryHierarchy>
                      <ChartSeriesHierarchy>
                        <ChartMembers>
                          <ChartMember>
                            <Group Name="Chart28_SeriesGroup">
                              <GroupExpressions>
                                <GroupExpression>=Fields!ClientType.Value</GroupExpression>
                              </GroupExpressions>
                            </Group>
                            <SortExpressions>
                              <SortExpression>
                                <Value>=Fields!ClientType.Value</Value>
                              </SortExpression>
                            </SortExpressions>
                            <Label>=Fields!ClientType.Value</Label>
                          </ChartMember>
                        </ChartMembers>
                      </ChartSeriesHierarchy>
                      <ChartData>
                        <ChartSeriesCollection>
                          <ChartSeries Name="ClientNum">
                            <ChartDataPoints>
                              <ChartDataPoint>
                                <ChartDataPointValues>
                                  <Y>=Sum(Fields!ClientNum.Value)</Y>
                                </ChartDataPointValues>
                                <ChartDataLabel>
                                  <Style />
                                  <UseValueAsLabel>true</UseValueAsLabel>
                                  <Visible>true</Visible>
                                </ChartDataLabel>
                                <Style />
                                <ChartMarker>
                                  <Style />
                                </ChartMarker>
                                <DataElementOutput>Output</DataElementOutput>
                              </ChartDataPoint>
                            </ChartDataPoints>
                            <Subtype>Stacked</Subtype>
                            <Style />
                            <ChartEmptyPoints>
                              <Style />
                              <ChartMarker>
                                <Style />
                              </ChartMarker>
                              <ChartDataLabel>
                                <Style />
                              </ChartDataLabel>
                            </ChartEmptyPoints>
                            <ValueAxisName>Primary</ValueAxisName>
                            <CategoryAxisName>Primary</CategoryAxisName>
                            <ChartSmartLabel>
                              <CalloutLineColor>Black</CalloutLineColor>
                              <MinMovingDistance>0pt</MinMovingDistance>
                            </ChartSmartLabel>
                          </ChartSeries>
                        </ChartSeriesCollection>
                      </ChartData>
                      <ChartAreas>
                        <ChartArea Name="Default">
                          <ChartCategoryAxes>
                            <ChartAxis Name="Primary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Year / Month</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <Margin>False</Margin>
                              <Interval>1</Interval>
                              <ChartMajorGridLines>
                                <Enabled>False</Enabled>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                            <ChartAxis Name="Secondary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Axis Title</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Enabled>False</Enabled>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Location>Opposite</Location>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                          </ChartCategoryAxes>
                          <ChartValueAxes>
                            <ChartAxis Name="Primary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Paying Clients Qty</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                            <ChartAxis Name="Secondary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Axis Title</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Location>Opposite</Location>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                          </ChartValueAxes>
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                          </Style>
                        </ChartArea>
                      </ChartAreas>
                      <ChartLegends>
                        <ChartLegend Name="Default">
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                            <FontSize>8pt</FontSize>
                          </Style>
                          <Position>BottomCenter</Position>
                          <ChartLegendTitle>
                            <Caption />
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </ChartLegendTitle>
                          <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                          <ColumnSeparatorColor>Black</ColumnSeparatorColor>
                        </ChartLegend>
                      </ChartLegends>
                      <ChartTitles>
                        <ChartTitle Name="Default">
                          <Caption>=Fields!ManagerName.Value</Caption>
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                            <FontWeight>Bold</FontWeight>
                            <TextAlign>General</TextAlign>
                            <VerticalAlign>Top</VerticalAlign>
                          </Style>
                        </ChartTitle>
                      </ChartTitles>
                      <Palette>BrightPastel</Palette>
                      <ChartBorderSkin>
                        <Style>
                          <BackgroundColor>Gray</BackgroundColor>
                          <BackgroundGradientType>None</BackgroundGradientType>
                          <Color>White</Color>
                        </Style>
                      </ChartBorderSkin>
                      <ChartNoDataMessage Name="NoDataMessage">
                        <Caption>No Data Available</Caption>
                        <Style>
                          <BackgroundGradientType>None</BackgroundGradientType>
                          <TextAlign>General</TextAlign>
                          <VerticalAlign>Top</VerticalAlign>
                        </Style>
                      </ChartNoDataMessage>
                      <DataSetName>DStClientsMonths</DataSetName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>None</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <BackgroundGradientType>None</BackgroundGradientType>
                      </Style>
                    </Chart>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.07938cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Rectangle Name="Rectangle10">
                      <KeepTogether>true</KeepTogether>
                      <Style>
                        <Border>
                          <Style>None</Style>
                        </Border>
                      </Style>
                    </Rectangle>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="ManagerName">
                <GroupExpressions>
                  <GroupExpression>=Fields!ManagerName.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!ManagerName.Value</Value>
                </SortExpression>
              </SortExpressions>
            </TablixMember>
            <TablixMember>
              <Group Name="Details" />
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DStClientsMonths</DataSetName>
        <Top>12cm</Top>
        <Height>11cm</Height>
        <Width>17.5cm</Width>
        <ZIndex>1</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
      <Tablix Name="Tablix12">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>17.5cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>10.92062cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Chart Name="Chart29">
                      <ChartCategoryHierarchy>
                        <ChartMembers>
                          <ChartMember>
                            <Group Name="Chart29_CategoryGroup">
                              <GroupExpressions>
                                <GroupExpression>=Fields!YearNum.Value</GroupExpression>
                              </GroupExpressions>
                            </Group>
                            <SortExpressions>
                              <SortExpression>
                                <Value>=Fields!YearNum.Value</Value>
                              </SortExpression>
                            </SortExpressions>
                            <ChartMembers>
                              <ChartMember>
                                <Group Name="Chart29_CategoryGroup1">
                                  <GroupExpressions>
                                    <GroupExpression>=Fields!QuarterNum.Value</GroupExpression>
                                  </GroupExpressions>
                                </Group>
                                <SortExpressions>
                                  <SortExpression>
                                    <Value>=Fields!QuarterNum.Value</Value>
                                  </SortExpression>
                                </SortExpressions>
                                <Label>="Q" + CStr(Fields!QuarterNum.Value)</Label>
                              </ChartMember>
                            </ChartMembers>
                            <Label>=Fields!YearNum.Value</Label>
                          </ChartMember>
                        </ChartMembers>
                      </ChartCategoryHierarchy>
                      <ChartSeriesHierarchy>
                        <ChartMembers>
                          <ChartMember>
                            <Group Name="Chart29_SeriesGroup">
                              <GroupExpressions>
                                <GroupExpression>=Fields!ClientType.Value</GroupExpression>
                              </GroupExpressions>
                            </Group>
                            <SortExpressions>
                              <SortExpression>
                                <Value>=Fields!ClientType.Value</Value>
                              </SortExpression>
                            </SortExpressions>
                            <Label>=Fields!ClientType.Value</Label>
                          </ChartMember>
                        </ChartMembers>
                      </ChartSeriesHierarchy>
                      <ChartData>
                        <ChartSeriesCollection>
                          <ChartSeries Name="ClientNum">
                            <ChartDataPoints>
                              <ChartDataPoint>
                                <ChartDataPointValues>
                                  <Y>=Sum(Fields!ClientNum.Value)</Y>
                                </ChartDataPointValues>
                                <ChartDataLabel>
                                  <Style />
                                  <UseValueAsLabel>true</UseValueAsLabel>
                                  <Visible>true</Visible>
                                </ChartDataLabel>
                                <Style />
                                <ChartMarker>
                                  <Style />
                                </ChartMarker>
                                <DataElementOutput>Output</DataElementOutput>
                              </ChartDataPoint>
                            </ChartDataPoints>
                            <Subtype>Stacked</Subtype>
                            <Style />
                            <ChartEmptyPoints>
                              <Style />
                              <ChartMarker>
                                <Style />
                              </ChartMarker>
                              <ChartDataLabel>
                                <Style />
                              </ChartDataLabel>
                            </ChartEmptyPoints>
                            <ValueAxisName>Primary</ValueAxisName>
                            <CategoryAxisName>Primary</CategoryAxisName>
                            <ChartSmartLabel>
                              <CalloutLineColor>Black</CalloutLineColor>
                              <MinMovingDistance>0pt</MinMovingDistance>
                            </ChartSmartLabel>
                          </ChartSeries>
                        </ChartSeriesCollection>
                      </ChartData>
                      <ChartAreas>
                        <ChartArea Name="Default">
                          <ChartCategoryAxes>
                            <ChartAxis Name="Primary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Year / Month</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <Margin>False</Margin>
                              <Interval>1</Interval>
                              <ChartMajorGridLines>
                                <Enabled>False</Enabled>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                            <ChartAxis Name="Secondary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Axis Title</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Enabled>False</Enabled>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Location>Opposite</Location>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                          </ChartCategoryAxes>
                          <ChartValueAxes>
                            <ChartAxis Name="Primary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Paying Clients Qty</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                            <ChartAxis Name="Secondary">
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                              <ChartAxisTitle>
                                <Caption>Axis Title</Caption>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </ChartAxisTitle>
                              <ChartMajorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                  </Border>
                                </Style>
                              </ChartMajorGridLines>
                              <ChartMinorGridLines>
                                <Style>
                                  <Border>
                                    <Color>Gainsboro</Color>
                                    <Style>Dotted</Style>
                                  </Border>
                                </Style>
                              </ChartMinorGridLines>
                              <ChartMinorTickMarks>
                                <Length>0.5</Length>
                              </ChartMinorTickMarks>
                              <CrossAt>NaN</CrossAt>
                              <Location>Opposite</Location>
                              <Minimum>NaN</Minimum>
                              <Maximum>NaN</Maximum>
                              <ChartAxisScaleBreak>
                                <Style />
                              </ChartAxisScaleBreak>
                            </ChartAxis>
                          </ChartValueAxes>
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                          </Style>
                        </ChartArea>
                      </ChartAreas>
                      <ChartLegends>
                        <ChartLegend Name="Default">
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                            <FontSize>8pt</FontSize>
                          </Style>
                          <Position>BottomCenter</Position>
                          <ChartLegendTitle>
                            <Caption />
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </ChartLegendTitle>
                          <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                          <ColumnSeparatorColor>Black</ColumnSeparatorColor>
                        </ChartLegend>
                      </ChartLegends>
                      <ChartTitles>
                        <ChartTitle Name="Default">
                          <Caption>=Fields!ManagerName.Value</Caption>
                          <Style>
                            <BackgroundGradientType>None</BackgroundGradientType>
                            <FontWeight>Bold</FontWeight>
                            <TextAlign>General</TextAlign>
                            <VerticalAlign>Top</VerticalAlign>
                          </Style>
                        </ChartTitle>
                      </ChartTitles>
                      <Palette>BrightPastel</Palette>
                      <ChartBorderSkin>
                        <Style>
                          <BackgroundColor>Gray</BackgroundColor>
                          <BackgroundGradientType>None</BackgroundGradientType>
                          <Color>White</Color>
                        </Style>
                      </ChartBorderSkin>
                      <ChartNoDataMessage Name="NoDataMessage">
                        <Caption>No Data Available</Caption>
                        <Style>
                          <BackgroundGradientType>None</BackgroundGradientType>
                          <TextAlign>General</TextAlign>
                          <VerticalAlign>Top</VerticalAlign>
                        </Style>
                      </ChartNoDataMessage>
                      <DataSetName>DStClientsQuarter</DataSetName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>None</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <BackgroundGradientType>None</BackgroundGradientType>
                      </Style>
                    </Chart>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.07938cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Rectangle Name="Rectangle11">
                      <KeepTogether>true</KeepTogether>
                      <Style>
                        <Border>
                          <Style>None</Style>
                        </Border>
                      </Style>
                    </Rectangle>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="ManagerName1">
                <GroupExpressions>
                  <GroupExpression>=Fields!ManagerName.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!ManagerName.Value</Value>
                </SortExpression>
              </SortExpressions>
            </TablixMember>
            <TablixMember>
              <Group Name="Details1" />
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DStClientsQuarter</DataSetName>
        <Top>12cm</Top>
        <Left>17.5cm</Left>
        <Height>11cm</Height>
        <Width>17.5cm</Width>
        <ZIndex>2</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
      <Textbox Name="Textbox44">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Number of Paying Clients by Months / Quarters</Value>
                <Style>
                  <FontSize>12pt</FontSize>
                  <FontWeight>Bold</FontWeight>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>Textbox44</rd:DefaultName>
        <Height>1cm</Height>
        <Width>33.05937cm</Width>
        <ZIndex>3</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <VerticalAlign>Middle</VerticalAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Chart Name="Chart30">
        <ChartCategoryHierarchy>
          <ChartMembers>
            <ChartMember>
              <Group Name="Chart30_CategoryGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!YearNum.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!YearNum.Value</Value>
                </SortExpression>
              </SortExpressions>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart30_CategoryGroup1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!QuarterNum.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!QuarterNum.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>="Q" + CStr(Fields!QuarterNum.Value)</Label>
                </ChartMember>
              </ChartMembers>
              <Label>=Fields!YearNum.Value</Label>
            </ChartMember>
          </ChartMembers>
        </ChartCategoryHierarchy>
        <ChartSeriesHierarchy>
          <ChartMembers>
            <ChartMember>
              <Group Name="Chart30_SeriesGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!ClientType.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!ClientType.Value</Value>
                </SortExpression>
              </SortExpressions>
              <Label>=Fields!ClientType.Value</Label>
            </ChartMember>
          </ChartMembers>
        </ChartSeriesHierarchy>
        <ChartData>
          <ChartSeriesCollection>
            <ChartSeries Name="ClientNum">
              <ChartDataPoints>
                <ChartDataPoint>
                  <ChartDataPointValues>
                    <Y>=Sum(Fields!ClientNum.Value)</Y>
                  </ChartDataPointValues>
                  <ChartDataLabel>
                    <Style />
                    <UseValueAsLabel>true</UseValueAsLabel>
                    <Visible>true</Visible>
                  </ChartDataLabel>
                  <Style />
                  <ChartMarker>
                    <Style />
                  </ChartMarker>
                  <DataElementOutput>Output</DataElementOutput>
                </ChartDataPoint>
              </ChartDataPoints>
              <Subtype>Stacked</Subtype>
              <Style />
              <ChartEmptyPoints>
                <Style />
                <ChartMarker>
                  <Style />
                </ChartMarker>
                <ChartDataLabel>
                  <Style />
                </ChartDataLabel>
              </ChartEmptyPoints>
              <ValueAxisName>Primary</ValueAxisName>
              <CategoryAxisName>Primary</CategoryAxisName>
              <ChartSmartLabel>
                <CalloutLineColor>Black</CalloutLineColor>
                <MinMovingDistance>0pt</MinMovingDistance>
              </ChartSmartLabel>
            </ChartSeries>
          </ChartSeriesCollection>
        </ChartData>
        <ChartAreas>
          <ChartArea Name="Default">
            <ChartCategoryAxes>
              <ChartAxis Name="Primary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Year / Month</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <Margin>False</Margin>
                <Interval>1</Interval>
                <ChartMajorGridLines>
                  <Enabled>False</Enabled>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
              <ChartAxis Name="Secondary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Axis Title</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Enabled>False</Enabled>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Location>Opposite</Location>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
            </ChartCategoryAxes>
            <ChartValueAxes>
              <ChartAxis Name="Primary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Paying Clients Qty</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
              <ChartAxis Name="Secondary">
                <Style>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartAxisTitle>
                  <Caption>Axis Title</Caption>
                  <Style>
                    <FontSize>8pt</FontSize>
                  </Style>
                </ChartAxisTitle>
                <ChartMajorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                    </Border>
                  </Style>
                </ChartMajorGridLines>
                <ChartMinorGridLines>
                  <Style>
                    <Border>
                      <Color>Gainsboro</Color>
                      <Style>Dotted</Style>
                    </Border>
                  </Style>
                </ChartMinorGridLines>
                <ChartMinorTickMarks>
                  <Length>0.5</Length>
                </ChartMinorTickMarks>
                <CrossAt>NaN</CrossAt>
                <Location>Opposite</Location>
                <Minimum>NaN</Minimum>
                <Maximum>NaN</Maximum>
                <ChartAxisScaleBreak>
                  <Style />
                </ChartAxisScaleBreak>
              </ChartAxis>
            </ChartValueAxes>
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </ChartArea>
        </ChartAreas>
        <ChartLegends>
          <ChartLegend Name="Default">
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
              <FontSize>8pt</FontSize>
            </Style>
            <Position>BottomCenter</Position>
            <ChartLegendTitle>
              <Caption />
              <Style>
                <FontSize>8pt</FontSize>
                <FontWeight>Bold</FontWeight>
                <TextAlign>Center</TextAlign>
              </Style>
            </ChartLegendTitle>
            <HeaderSeparatorColor>Black</HeaderSeparatorColor>
            <ColumnSeparatorColor>Black</ColumnSeparatorColor>
          </ChartLegend>
        </ChartLegends>
        <ChartTitles>
          <ChartTitle Name="Default">
            <Caption>All Managers</Caption>
            <Style>
              <BackgroundGradientType>None</BackgroundGradientType>
              <FontWeight>Bold</FontWeight>
              <TextAlign>General</TextAlign>
              <VerticalAlign>Top</VerticalAlign>
            </Style>
          </ChartTitle>
        </ChartTitles>
        <Palette>BrightPastel</Palette>
        <ChartBorderSkin>
          <Style>
            <BackgroundColor>Gray</BackgroundColor>
            <BackgroundGradientType>None</BackgroundGradientType>
            <Color>White</Color>
          </Style>
        </ChartBorderSkin>
        <ChartNoDataMessage Name="NoDataMessage">
          <Caption>No Data Available</Caption>
          <Style>
            <BackgroundGradientType>None</BackgroundGradientType>
            <TextAlign>General</TextAlign>
            <VerticalAlign>Top</VerticalAlign>
          </Style>
        </ChartNoDataMessage>
        <DataSetName>DStClientsQuarter</DataSetName>
        <Top>1cm</Top>
        <Left>17.5cm</Left>
        <Height>11cm</Height>
        <Width>17.5cm</Width>
        <ZIndex>4</ZIndex>
        <Style>
          <Border>
            <Color>LightGrey</Color>
            <Style>None</Style>
          </Border>
          <BackgroundColor>White</BackgroundColor>
          <BackgroundGradientType>None</BackgroundGradientType>
        </Style>
      </Chart>
    </ReportItems>
    <Height>9.05512in</Height>
    <Style>
      <BackgroundColor>WhiteSmoke</BackgroundColor>
    </Style>
  </Body>
  <Width>13.8189in</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <InteractiveHeight>0cm</InteractiveHeight>
    <InteractiveWidth>21cm</InteractiveWidth>
    <LeftMargin>2cm</LeftMargin>
    <RightMargin>2cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
    <ColumnSpacing>0.13cm</ColumnSpacing>
    <Style>
      <BackgroundColor>WhiteSmoke</BackgroundColor>
    </Style>
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DSrcReporting">
      <DataSourceReference>DSrcReporting</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>e4e690ac-1995-4040-9e63-401fbd736716</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DStManagers">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <CommandText>SELECT M.ID, M.Name, D.Name AS Department
FROM SRV12.RabotaUA2.dbo.Manager M
 JOIN SRV12.RabotaUA2.dbo.Departments D ON M.DepartmentID = D.ID
WHERE DepartmentID IN (2,3,4) 
 AND IsForTesting = 0 
ORDER BY Name</CommandText>
      </Query>
      <Fields>
        <Field Name="ID">
          <DataField>ID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Department">
          <DataField>Department</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=Fields!Department.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!Department.Value</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
    <DataSet Name="DStClientsMonths">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@ManagerID">
            <Value>=Parameters!ManagerID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartDate">
            <Value>=Parameters!StartDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndDate">
            <Value>=Parameters!EndDate.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>WITH C_Revenue_Month AS
 (
SELECT
   M.Id AS ManagerID
 , M.Name AS ManagerName
 , NC.NotebookId
 , NC.Name AS CompanyName
 , DD.YearNum
 , DD.MonthNum
 , DD.MonthNameEng
 , DD.MonthNameRus
 , RRN.Service_key
 , SUM(RRN.RecognizedRevenue) AS SumRecognizedRevenue
FROM Analytics.dbo.NotebookCompany NC
 JOIN Analytics.dbo.Manager M ON NC.ManagerId = M.Id
 JOIN Reporting.dbo.FactRecognizedRevenueNotebook RRN ON NC.NotebookId = RRN.NotebookID
 JOIN Reporting.dbo.DimDate DD ON RRN.Date_key = DD.Date_key
WHERE M.Id IN (@ManagerID) AND DD.FullDate BETWEEN @StartDate AND @EndDate
GROUP BY 
   M.Id
 , M.Name
 , NC.NotebookId
 , NC.Name
 , DD.YearNum
 , DD.MonthNum
 , DD.MonthNameEng
 , DD.MonthNameRus
 , RRN.Service_key
HAVING SUM(RRN.RecognizedRevenue) &gt; 0
 )
 , C_Revenue_ActivityGroups AS
 (
SELECT 
   *
 , CASE 
    WHEN EXISTS (SELECT * 
				 FROM C_Revenue_Month 
				 WHERE NotebookId = CRM.NotebookId AND YearNum = CRM.YearNum AND MonthNum = CRM.MonthNum
				  AND Service_key &lt;&gt; 10 AND SumRecognizedRevenue &gt; 0) THEN 'Активный клиент'
    ELSE 'Пассивный клиент'
   END AS ClientType
FROM C_Revenue_Month CRM
 )
SELECT 
   ManagerID
 , ManagerName
 , ClientType
 , YearNum
 , MonthNum
 , MonthNameEng
 , MonthNameRus
 , COUNT(DISTINCT NotebookID) AS ClientNum
FROM C_Revenue_ActivityGroups
GROUP BY 
   ManagerID
 , ManagerName
 , ClientType
 , YearNum
 , MonthNum
 , MonthNameEng
 , MonthNameRus
</CommandText>
      </Query>
      <Fields>
        <Field Name="ManagerID">
          <DataField>ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ManagerName">
          <DataField>ManagerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ClientType">
          <DataField>ClientType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="YearNum">
          <DataField>YearNum</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="MonthNum">
          <DataField>MonthNum</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="MonthNameEng">
          <DataField>MonthNameEng</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MonthNameRus">
          <DataField>MonthNameRus</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ClientNum">
          <DataField>ClientNum</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DStClientsQuarter">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@ManagerID">
            <Value>=Parameters!ManagerID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartDate">
            <Value>=Parameters!StartDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndDate">
            <Value>=Parameters!EndDate.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>WITH C_Revenue_Month AS
 (
SELECT
   M.Id AS ManagerID
 , M.Name AS ManagerName
 , NC.NotebookId
 , NC.Name AS CompanyName
 , DD.YearNum
 , DD.QuarterNum
 , RRN.Service_key
 , SUM(RRN.RecognizedRevenue) AS SumRecognizedRevenue
FROM Analytics.dbo.NotebookCompany NC
 JOIN Analytics.dbo.Manager M ON NC.ManagerId = M.Id
 JOIN Reporting.dbo.FactRecognizedRevenueNotebook RRN ON NC.NotebookId = RRN.NotebookID
 JOIN Reporting.dbo.DimDate DD ON RRN.Date_key = DD.Date_key
WHERE M.Id IN (@ManagerID) AND DD.FullDate BETWEEN @StartDate AND @EndDate
GROUP BY 
   M.Id
 , M.Name
 , NC.NotebookId
 , NC.Name
 , DD.YearNum
 , DD.QuarterNum
 , RRN.Service_key
HAVING SUM(RRN.RecognizedRevenue) &gt; 0
 )
 , C_Revenue_ActivityGroups AS
 (
SELECT 
   *
 , CASE 
    WHEN EXISTS (SELECT * 
				 FROM C_Revenue_Month 
				 WHERE NotebookId = CRM.NotebookId AND YearNum = CRM.YearNum AND QuarterNum = CRM.QuarterNum
				  AND Service_key &lt;&gt; 10 AND SumRecognizedRevenue &gt; 0) THEN 'Активный клиент'
    ELSE 'Пассивный клиент'
   END AS ClientType
FROM C_Revenue_Month CRM
 )
SELECT 
   ManagerID
 , ManagerName
 , ClientType
 , YearNum
 , QuarterNum
 , COUNT(DISTINCT NotebookID) AS ClientNum
FROM C_Revenue_ActivityGroups
GROUP BY 
   ManagerID
 , ManagerName
 , ClientType
 , YearNum
 , QuarterNum
</CommandText>
      </Query>
      <Fields>
        <Field Name="ManagerID">
          <DataField>ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ManagerName">
          <DataField>ManagerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ClientType">
          <DataField>ClientType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="YearNum">
          <DataField>YearNum</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="QuarterNum">
          <DataField>QuarterNum</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="ClientNum">
          <DataField>ClientNum</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DstDepartments">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <CommandText>SELECT Name 
FROM SRV12.RabotaUA2.dbo.Departments
WHERE Id IN (2,3,4)
ORDER BY Name</CommandText>
      </Query>
      <Fields>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="StartDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=DateAdd("d", 1 - Day(DateAdd("Q", - 5, Today())), DateAdd("Q", - 5, Today()))</Value>
        </Values>
      </DefaultValue>
      <Prompt>Укажите начальную дату:</Prompt>
    </ReportParameter>
    <ReportParameter Name="EndDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=Today()</Value>
        </Values>
      </DefaultValue>
      <Prompt>Укажите конечную дату:</Prompt>
    </ReportParameter>
    <ReportParameter Name="Department">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DstDepartments</DataSetName>
          <ValueField>Name</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Отдел</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DstDepartments</DataSetName>
          <ValueField>Name</ValueField>
          <LabelField>Name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="ManagerID">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DStManagers</DataSetName>
          <ValueField>ID</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Выберите менеджеров</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DStManagers</DataSetName>
          <ValueField>ID</ValueField>
          <LabelField>Name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>e4e2b418-68fd-4feb-aded-1fa165ad8ca4</rd:ReportID>
</Report>