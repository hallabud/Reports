<?xml version="1.0" encoding="utf-8"?>
<Report MustUnderstand="df" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:df="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition/defaultfontfamily">
  <df:DefaultFontFamily>Segoe UI</df:DefaultFontFamily>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DSrcReporting">
      <DataSourceReference>DSrcReporting</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>4374603f-691d-40b3-8679-192ff90ff313</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DStListOfSpecialOffers">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <CommandType>StoredProcedure</CommandType>
        <CommandText>usp_ssrs_Report_SpecialOffers_ListOfSpecOffers</CommandText>
      </Query>
      <Fields>
        <Field Name="ServiceID">
          <DataField>ServiceID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ServiceName">
          <DataField>ServiceName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="StartDate">
          <DataField>StartDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="EndDate">
          <DataField>EndDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DStDefaultStartDate">
      <Query>
        <DataSourceName>DSrcReporting</DataSourceName>
        <CommandText>SELECT 
	CASE 
		WHEN StartDate &lt;= DATEADD(DAY, -90, CONVERT(DATE, GETDATE())) THEN DATEADD(DAY, -90, CONVERT(DATE, GETDATE())) 
		ELSE StartDate
	END	AS StartDate, 
	ID AS ServiceID
FROM SRV16.RabotaUA2.dbo.OrderService WITH (NOLOCK)
WHERE IsSpecialOffer = 1;</CommandText>
      </Query>
      <Fields>
        <Field Name="StartDate">
          <DataField>StartDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="ServiceID">
          <DataField>ServiceID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=Fields!ServiceID.Value</FilterExpression>
          <Operator>Equal</Operator>
          <FilterValues>
            <FilterValue>=Parameters!SpecOffer.Value</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
    <DataSet Name="DStSalesTeams">
      <SharedDataSet>
        <SharedDataSetReference>DStSalesTeamsDistinct</SharedDataSetReference>
      </SharedDataSet>
      <Fields>
        <Field Name="SalesTeamName">
          <DataField>SalesTeamName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesManagerID">
          <DataField>SalesManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="SalesManagerName">
          <DataField>SalesManagerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DStSTMs">
      <SharedDataSet>
        <SharedDataSetReference>DStSTMs</SharedDataSetReference>
      </SharedDataSet>
      <Fields>
        <Field Name="ManagerID">
          <DataField>ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ManagerName">
          <DataField>ManagerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TeamLead_ManagerID">
          <DataField>TeamLead_ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=Fields!TeamLead_ManagerID.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!SalesTeam.Value</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
    <DataSet Name="DStManagers">
      <SharedDataSet>
        <SharedDataSetReference>DStManagersDistinct</SharedDataSetReference>
      </SharedDataSet>
      <Fields>
        <Field Name="ManagerID">
          <DataField>ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ManagerName">
          <DataField>ManagerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TeamLead_ManagerID">
          <DataField>TeamLead_ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="IsLoyaltyGroup">
          <DataField>IsLoyaltyGroup</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
        <Field Name="Email">
          <DataField>Email</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentID">
          <DataField>DepartmentID</DataField>
          <rd:TypeName>System.Byte</rd:TypeName>
        </Field>
        <Field Name="STM_ManagerID">
          <DataField>STM_ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Real_STM_ManagerID">
          <DataField>Real_STM_ManagerID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=Fields!Real_STM_ManagerID.Value</FilterExpression>
          <Operator>In</Operator>
          <FilterValues>
            <FilterValue>=Parameters!STM.Value</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>2cm</LeftMargin>
        <RightMargin>2cm</RightMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="SpecOffer">
      <DataType>Integer</DataType>
      <Prompt>Название акции</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DStListOfSpecialOffers</DataSetName>
          <ValueField>ServiceID</ValueField>
          <LabelField>ServiceName</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="StartDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DStDefaultStartDate</DataSetName>
          <ValueField>StartDate</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Начальная дата</Prompt>
    </ReportParameter>
    <ReportParameter Name="EndDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=Today</Value>
        </Values>
      </DefaultValue>
      <Prompt>Конечная дата</Prompt>
    </ReportParameter>
    <ReportParameter Name="Interval">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>неделя</Value>
        </Values>
      </DefaultValue>
      <Prompt>Интервал</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>неделя</Value>
            <Label>неделя</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>месяц</Value>
            <Label>месяц</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="SalesTeam">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DStSalesTeams</DataSetName>
          <ValueField>SalesManagerID</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>SalesTeam</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DStSalesTeams</DataSetName>
          <ValueField>SalesManagerID</ValueField>
          <LabelField>SalesTeamName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="STM">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DStSTMs</DataSetName>
          <ValueField>ManagerID</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>STM</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DStSTMs</DataSetName>
          <ValueField>ManagerID</ValueField>
          <LabelField>ManagerName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Manager">
      <DataType>Integer</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DStManagers</DataSetName>
          <ValueField>ManagerID</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Manager</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DStManagers</DataSetName>
          <ValueField>ManagerID</ValueField>
          <LabelField>ManagerName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>4</NumberOfColumns>
      <NumberOfRows>2</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>SpecOffer</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>1</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>StartDate</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>2</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>EndDate</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>3</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>Interval</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>SalesTeam</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>1</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>STM</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>2</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>Manager</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>50ae8655-8ca7-45f8-9200-57f1a6f8a81c</rd:ReportID>
</Report>